import{r as u,j as e,b as W}from"./app-D9cWeyPu.js";import{t as M,m as F,a as $,c as G,f as U}from"./format-Dt71a7ij.js";import{F as J}from"./ChevronLeftIcon-DJKt1waj.js";function H({title:s,titleId:t,...r},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),s?u.createElement("title",{id:t},s):null,u.createElement("path",{fillRule:"evenodd",d:"M12.53 16.28a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 0 1 1.06-1.06L12 14.69l6.97-6.97a.75.75 0 1 1 1.06 1.06l-7.5 7.5Z",clipRule:"evenodd"}))}const L=u.forwardRef(H);function z(s,t){const r=()=>G(t==null?void 0:t.in,NaN),a=V(s);let c;if(a.date){const l=X(a.date,2);c=Q(l.restDateString,l.year)}if(!c||isNaN(+c))return r();const f=+c;let d=0,o;if(a.time&&(d=ee(a.time),isNaN(d)))return r();if(a.timezone){if(o=te(a.timezone),isNaN(o))return r()}else{const l=new Date(f+d),x=M(0,t==null?void 0:t.in);return x.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),x.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),x}return M(f+d+o,t==null?void 0:t.in)}const N={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},A=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,B=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,K=/^([+-])(\d{2})(?::?(\d{2}))?$/;function V(s){const t={},r=s.split(N.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],N.timeZoneDelimiter.test(t.date)&&(t.date=s.split(N.timeZoneDelimiter)[0],n=s.substr(t.date.length,s.length))),n){const a=N.timezone.exec(n);a?(t.time=n.replace(a[1],""),t.timezone=a[1]):t.time=n}return t}function X(s,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=s.match(r);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,c=n[2]?parseInt(n[2]):null;return{year:c===null?a:c*100,restDateString:s.slice((n[1]||n[2]).length)}}function Q(s,t){if(t===null)return new Date(NaN);const r=s.match(A);if(!r)return new Date(NaN);const n=!!r[4],a=p(r[1]),c=p(r[2])-1,f=p(r[3]),d=p(r[4]),o=p(r[5])-1;if(n)return ie(t,d,o)?se(t,d,o):new Date(NaN);{const l=new Date(0);return!ne(t,c,f)||!ae(t,a)?new Date(NaN):(l.setUTCFullYear(t,c,Math.max(a,f)),l)}}function p(s){return s?parseInt(s):1}function ee(s){const t=s.match(B);if(!t)return NaN;const r=w(t[1]),n=w(t[2]),a=w(t[3]);return le(r,n,a)?r*F+n*$+a*1e3:NaN}function w(s){return s&&parseFloat(s.replace(",","."))||0}function te(s){if(s==="Z")return 0;const t=s.match(K);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return ce(n,a)?r*(n*F+a*$):NaN}function se(s,t,r){const n=new Date(0);n.setUTCFullYear(s,0,4);const a=n.getUTCDay()||7,c=(t-1)*7+r+1-a;return n.setUTCDate(n.getUTCDate()+c),n}const re=[31,null,31,30,31,30,31,31,30,31,30,31];function Y(s){return s%400===0||s%4===0&&s%100!==0}function ne(s,t,r){return t>=0&&t<=11&&r>=1&&r<=(re[t]||(Y(s)?29:28))}function ae(s,t){return t>=1&&t<=(Y(s)?366:365)}function ie(s,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function le(s,t,r){return s===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&s>=0&&s<25}function ce(s,t){return t>=0&&t<=59}const ue=({user:s,routeData:t,bookingData:r,seatNumber:n,seatCount:a,credit:c})=>{var P,T,C,S,E,I,k,O,R;const[f,d]=u.useState(null),o={busInfo:{name:"Shuttle Bus Tripin",plateNumber:(T=(P=t[0])==null?void 0:P.vehicles[0])==null?void 0:T.license_plate,duration:"2 h 45 m",departureTime:(S=(C=t[0])==null?void 0:C.vehicles[0])==null?void 0:S.pivot.departure_time,departureDate:U(z(r.selectedDay),"EEE, d MMM yyyy"),arrivalTime:(I=(E=t[0])==null?void 0:E.vehicles[0])==null?void 0:I.pivot.arrival_time,arrivalDate:U(z(r.selectedDay),"EEE, d MMM yyyy"),from:r.origin,to:(k=t[0])==null?void 0:k.name},orderDetails:{name:(s==null?void 0:s.username)??"user1",seatNumber:n,totalSeats:r.seatsValue,potentialPoints:null,exchangePoints:c},pricing:{seatPrice:parseFloat((R=(O=t[0])==null?void 0:O.vehicles[0])==null?void 0:R.pivot.price),quantity:a}},[l,x]=u.useState(!1),[b,_]=u.useState(!1),i=o;let g=i.pricing.seatPrice*i.pricing.quantity;o.orderDetails.potentialPoints=g*.05;let j=!1;l&&(j=!0,g=i.pricing.seatPrice*i.pricing.quantity-c),console.log(j);const D=y=>`Rp${y.toLocaleString("id-ID")}`,q=async y=>{y.preventDefault();const Z=document.head.querySelector('meta[name="csrf-token"]').content;try{const m=await W.post("/booking/order-detail/store",{amount:g,credit:o.orderDetails.potentialPoints,credit_status:j},{headers:{"X-CSRF-TOKEN":Z}}),{snap_token:v}=m.data;console.log(v),d(v),window.snap.pay(v,{onSuccess:function(h){alert("Payment Success! "+JSON.stringify(h))},onPending:function(h){alert("Payment Pending! "+JSON.stringify(h))},onError:function(h){alert("Payment Error! "+JSON.stringify(h))},onClose:function(){alert("You closed the popup without completing the payment.")}})}catch(m){m.response?(console.error("Server Error:",m.response.data),alert(m.response.data.message||"An error occurred on the server.")):m.request?(console.error("Network Error:",m.request),alert("Network error. Please check your internet connection and try again.")):(console.error("Error:",m.message),alert("An unexpected error occurred. Please try again."))}};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"lg:flex lg:justify-center",children:e.jsxs("div",{className:"min-h-screen bg-primary lg:max-w-[400px]",children:[e.jsxs("div",{className:"px-4 py-3 flex items-center text-white",children:[e.jsx(J,{className:"size-8 text-white cursor-pointer",onClick:()=>window.location.href="/booking"}),e.jsx("h1",{className:"text-2xl font-medium flex-1 text-center mr-6 mt-4 mb-4",children:"Confirmation"})]}),e.jsxs("div",{className:"bg-white min-h-screen pt-4 px-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Order Details"}),e.jsxs("div",{className:"bg-white shadow-md border border-gray-200 rounded-lg p-4 mb-4",children:[e.jsx("h3",{className:"font-medium mb-1",children:i.busInfo.name}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:i.busInfo.plateNumber}),e.jsxs("div",{className:"flex items-start gap-10",children:[e.jsxs("div",{className:"flex flex-col gap-10",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:i.busInfo.departureTime.split(":").slice(0,2).join(":")}),e.jsx("p",{className:"text-xs text-gray-500",children:i.busInfo.departureDate})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:i.busInfo.arrivalTime.split(":").slice(0,2).join(":")}),e.jsx("p",{className:"text-xs text-gray-500",children:i.busInfo.arrivalDate})]})]}),e.jsxs("div",{className:"relative flex flex-col items-center",children:[e.jsx("div",{className:"size-3 rounded-full bg-blue-500"}),e.jsx("div",{className:"w-1 h-20 bg-blue-300"}),e.jsx("div",{className:"size-2.5 rounded-full bg-blue-500 ring-4 ring-blue-200"})]}),e.jsxs("div",{className:"flex flex-col gap-16",children:[e.jsx("p",{className:"font-medium",children:i.busInfo.from}),e.jsx("p",{className:"font-medium",children:i.busInfo.to})]})]})]}),e.jsxs("div",{className:"bg-white shadow-md border border-gray-200 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-1",children:i.orderDetails.name}),e.jsxs("p",{className:"text-gray-700",children:["Seat x",i.orderDetails.totalSeats]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Seat Number"}),e.jsx("p",{className:"font-medium",children:i.orderDetails.seatNumber})]})]}),e.jsxs("div",{className:"flex justify-between bg-gray-50 rounded p-2 text-sm",children:[e.jsx("p",{className:"self-start",children:"Potential gain "}),e.jsx("p",{className:"text-orange-500 self-end",children:`${i.orderDetails.potentialPoints} CP`})]})]}),e.jsx("div",{className:"bg-white shadow-md border border-gray-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:"/credit.svg",alt:"Credits",className:"h-4"}),e.jsx("span",{children:`Exchange ${i.orderDetails.exchangePoints} CP`})]}),e.jsx("button",{onClick:()=>x(!l),className:`w-12 h-6 rounded-full transition-colors duration-200 ease-in-out relative ${l?"bg-orange-500":"bg-gray-200"}`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow transition-transform duration-200 ease-in-out absolute top-0.5 ${l?"translate-x-6":"translate-x-0.5"}`})})]})}),e.jsxs("div",{className:"bg-white shadow-md border border-gray-200 rounded-lg p-4 mb-4",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Payment Method"}),e.jsxs("div",{className:"relative",onClick:()=>_(!b),children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:"/gopay_icon.svg",alt:"GoPay",className:"w-6 h-6"}),e.jsx("span",{children:"GoPay"})]}),e.jsx(L,{className:`size-5 text-black transition-transform duration-200 ${b?"transform rotate-180":""}`})]}),b&&e.jsx("div",{className:"absolute w-full bg-white border rounded-lg mt-1 shadow-lg z-10",children:e.jsxs("div",{className:"p-2 flex items-center gap-2 cursor-pointer hover:bg-gray-50",children:[e.jsx("img",{src:"/gopay_icon.svg",alt:"GoPay",className:"w-6 h-6"}),e.jsx("span",{children:"GoPay"})]})})]})]}),e.jsxs("div",{className:"bg-white shadow-md border border-gray-200 rounded-lg p-4 mb-20",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Price Details"}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("p",{children:"Seat (x1)"}),e.jsx("p",{children:D(i.pricing.seatPrice)})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("p",{children:"Total seat"}),e.jsxs("p",{children:["(x",i.pricing.quantity,")"]})]}),e.jsxs("div",{className:"flex justify-between font-semibold pt-2 border-t",children:[e.jsx("p",{children:"Total Price"}),e.jsx("p",{children:D(g)})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 lg:translate-x-[-50%] lg:left-1/2 right-0 p-4 bg-white lg:w-[400px]",children:e.jsx("button",{className:"w-full bg-primary2 text-white py-3 rounded-lg font-semibold",onClick:q,children:"ORDER NOW"})})]})]})})})};export{ue as default};
